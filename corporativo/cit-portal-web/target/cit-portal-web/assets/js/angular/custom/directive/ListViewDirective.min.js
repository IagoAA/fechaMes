citApp.directive("listView",["$translate","$injector","$timeout","$filter",function(d,e,f,g){return{scope:{lista:"\x3dngLista",repository:"@ngRepository",headers:"\x3dngHeaders",filterCriteria:"\x3dngFilterCriteria",itemSelecionado:"\x3dngItemSelecionado",customRemove:"\x26ngCustomRemove",useCustomRemove:"@ngUseCustomRemove"},replace:!0,restrict:"E",templateUrl:"assets/js/angular/custom/directive/html/listView.html",controller:["$scope","$element","$attrs",function(a,f,g){a.totalPages=10;a.totalItens=
0;a.limit=10;a.repositorio=e.get(a.repository);a.appController=angular.element("#citapp-controller").scope();a.$showAdvancedFilters=!1;a.labelPalavraChave=d.instant("LABEL.DIGITE_UMA_PALAVRA_CHAVE");a.divisaoColunas=95/a.headers.length}],link:function(a,e,h){a.filterResult=function(b){""===a.filterCriteria.keywordValue&&""!==a.filterCriteria.keywordValue||a.runFilterResult(b)};a.runFilterResult=function(b){f(function(){void 0==b&&(a.filterCriteria.keywordValue=null);a.filterCriteria.start=1;a.fetchResult().then(function(){a.filterCriteria.start=
1})},200)};a.onSort=function(b,c){a.filterCriteria.dir=c;a.filterCriteria.sort=b;a.filterCriteria.start=1;a.fetchResult().then(function(){a.filterCriteria.start=1})};a.fetchResult=function(b){a.appController.setLoadingPesquisa(!0);a.itemSelecionado=void 0;return a.repositorio.getListPage(a.filterCriteria).then(function(b){a.lista=b.originalElement.objects;a.totalPages=b.originalElement.totalPages;a.totalItens=b.originalElement.totalItens;a.filtersCopy||(a.filtersCopy=angular.copy(a.filterCriteria.filters));
a.appController.setLoading(!1)},function(){a.lista=[];a.totalPages=0;a.totalItens=0})};a.remove=function(){if(!0===a.useCustomRemove||"true"===a.useCustomRemove)a.customRemove();else{var b=a.itemSelecionado;b&&b.id?a.appController.$openModalConfirm({message:d.instant("MSG.DESEJA_EXCLUIR_ITEM"),callback:a.excluir,item:b}):a.appController.showAlert("warning",d.instant("MSG.SELECIONE_ITEM_EXCLUIR"))}};a.excluir=function(){a.repositorio.remove(this.item).then(function(){a.appController.$modalConfirmInstance.dismiss("cancel");
a.appController.showAlert("success",d.instant("MSG.REGISTRO_EXCLUIDO"));a.fetchResult()})};a.limparFilters=function(){a.filterCriteria.keywordValue=null;a.filtersCopy&&(a.filterCriteria.filters=angular.copy(a.filtersCopy));a.fetchResult();a.$showAdvancedFilters=!1};a.fetchResult();a.$parent.fetchResult=a.fetchResult;a.$parent.remove=a.remove;a.$parent.filterResult=a.filterResult;a.aplicarFiltro=function(a,c){return g(c)(a)};a.$on("filtroDirective-listViewDirective",function(b,c){a.$showAdvancedFilters=
c})}}}]);