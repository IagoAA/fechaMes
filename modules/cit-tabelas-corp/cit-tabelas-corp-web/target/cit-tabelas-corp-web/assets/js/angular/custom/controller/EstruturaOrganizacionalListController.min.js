citApp.controller("EstruturaOrganizacionalListController",["$scope","EstruturaOrganizacionalRepository","DominioRepository","$translate",function(a,e,g,d){a.$showAdvancedFilters=!1;a.mostraArvore=!1;a.resetForm=function(a){angular.element("#editEstruturaOrganizacional").scope().resetForm(a)};a.headers=[{title:d.instant("LABEL.CODIGO"),value:"codigo"},{title:d.instant("LABEL.NOME"),value:"nome"},{title:d.instant("LABEL.SIGLA"),value:"sigla"},{title:d.instant("LABEL.TIPO_DE_ESTRUTURA_ORGANIZACIONAL"),
value:"dominioTipoEstruturaOrganizacional.descricao"}];a.filterCriteria={start:1,dir:"asc",sort:"codigo",limit:10,fields:["id","codigo","nome","sigla","dominioTipoEstruturaOrganizacional.descricao"],filters:[{type:"string",field:"codigo"},{type:"string",field:"nome"},{type:"string",field:"sigla"},{type:"string",field:"dominioTipoEstruturaOrganizacional.descricao",listaDominio:[]}]};g.findAllDominio("tipoEstruturaOrganizacional").then(function(b){a.filterCriteria.filters[3].listaDominio=b});a.fetchResultEstrutura=
function(){delete a.estruturaOrganizacionalChecked;a.mostraArvore?f():a.fetchResult()};a.mostrarArvore=function(){a.mostraArvore=!a.mostraArvore;delete a.estruturaOrganizacionalChecked;a.mostraArvore?f():a.fetchResultEstrutura()};var f=function(){a.exibirEstruturasAtivas=!0;a.$estruturaOrganizacionalBloqueada=!1;a.estruturasOrganizacionais=[];e.findParents(a.usuarioLogado.organizacao.id).then(function(b){for(var c=0;c<b.length;c++)b[c].originalElement.sinalPositivo=b[c].originalElement.possuiFilho,
a.estruturasOrganizacionais.push(b[c].originalElement)})};a.mostrarFilhos=function(b){b.sinalPositivo?(b.sinalPositivo=!b.sinalPositivo,a.setLoadingPesquisa(!0),b.subEstruturasOrganizacionais=[],e.findChildrens(b.originalElement?b.originalElement.id:b.id,a.exibirEstruturasAtivas).then(function(c){angular.forEach(c,function(a){a.originalElement.sinalPositivo=a.originalElement.possuiFilho;b.subEstruturasOrganizacionais.push(a.originalElement);a.originalElement.subEstruturasOrganizacionais=[]});a.setLoading(!1);
a.scrollToCadastro("#"+b.id)})):(b.sinalPositivo=!b.sinalPositivo&&void 0!==b.subEstruturasOrganizacionais&&0<b.subEstruturasOrganizacionais.length,b.subEstruturasOrganizacionais=[])};a.buscarTree=function(b){if(4<b.length)return a.setLoadingPesquisa(!0),a.estruturasOrganizacionais=[],e.listarEstruturasOrganizacionaisDaTree(a.usuarioLogado.organizacao.id,b,a.exibirEstruturasAtivas).then(function(b){a.estruturasOrganizacionais=[];angular.forEach(b,function(b){b.originalElement.sinalPositivo=!(b.originalElement.possuiFilho&&
0<b.originalElement.subEstruturasOrganizacionais.length);a.estruturasOrganizacionais.push(b.originalElement)});a.setLoading(!1)});0===b.length&&f()};a.removeEstrutura=function(a){angular.element("#editEstruturaOrganizacional").scope().remove(a)};a.abrirEstruturaOrganizacional=function(b,c){c||(c=a.estruturaOrganizacionalChecked);b||c?b&&!c?a.showAlert("warning",d.instant("MSG.SELECIONE_UM_ITEM_PARA_EDICAO")):(angular.element("#editEstruturaOrganizacional").scope().getEstruturaOrganizacional(c,b),
a.$showPageEditWorkspace(a.workspace)):a.showAlert("warning",d.instant("MSG.SELECIONE_UM_ITEM_PARA_VISUALIZACAO"))}}]);