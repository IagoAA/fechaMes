citApp.directive("componenteEndereco",["PaisRepository","RegiaoRepository","EstadoRepository","CidadeRepository","BairroRepository","DominioRepository","$translate","$modal","$injector","EnderecoRepository",function(g,h,k,l,m,n,p,q,r,s){return{scope:{enderecos:"\x3dngEnderecos",showCampos:"\x3d"},replace:!0,restrict:"EA",templateUrl:"/cit-tabelas-corp-web/assets/js/angular/custom/directive/html/endereco.html",link:function(a,r,t){a.MASK_CEP="99999-999";a.endereco={};a.obrigatorios={};a.obrigatorios.cep=
!1;a.obrigatorios.logradouro=!1;a.obrigatorios.complemento=!1;a.obrigatorios.bairro=!1;a.tipoEnderecos=[];n.findAllDominio("tipoEndereco").then(function(b){a.tipoEnderecos=b});a.findPais=function(a){return g.listarPais(a).then(function(a){return a})};a.setPaisEndereco=function(b){a.endereco.pais=b.originalElement};a.findRegiao=function(b){return h.findRegiao({objeto:a.pais,nome:b}).then(function(a){return a})};a.findEstado=function(b){var d={};angular.copy(a.regiao,d);angular.copy(a.pais,d.pais);
return k.findEstado({objeto:d,nome:b}).then(function(a){return a})};a.findCidade=function(b){var d={},c={},e={};angular.copy(a.pais,d);angular.copy(a.regiao,c);angular.copy(a.estado,e);c.pais=d;e.regiao=c;return l.findCidade({objeto:e,nome:b}).then(function(a){return a})};a.findBairro=function(b){var d={},c={},e={},f={};angular.copy(a.pais,d);angular.copy(a.regiao,c);angular.copy(a.estado,e);angular.copy(a.cidade,f);c.pais=d;e.regiao=c;f.estado=e;return m.findBairro({objeto:f,nome:b}).then(function(a){return a})};
a.setPais=function(b){a.pais=b.pais;a.estado=null;a.cidade=null};a.setRegiaoPais=function(b){a.regiao=b.regiao;a.pais=b.regiao.pais};a.setEstadoRegiaoPais=function(b){a.estado=b.estado;a.regiao=b.estado.regiao;a.pais=b.estado.regiao.pais};a.setCidadeEstadoRegiaoPais=function(b){a.cidade=b.cidade;a.estado=b.cidade.estado;a.regiao=b.cidade.estado.regiao;a.pais=b.cidade.estado.regiao.pais};a.iniciarPropriedadesEndereco=function(){a.endereco.cidade||(a.endereco.cidade={});a.endereco.cidade.estado||(a.endereco.cidade.estado=
{});a.endereco.cidade.estado.regiao||(a.endereco.cidade.estado.regiao={});a.endereco.cidade.estado.regiao.pais||(a.endereco.cidade.estado.regiao.pais={})};a.limparFilhosAutoComplete=function(b){"pais"==b&&(a.regiao=null);a.estado=null;a.cidade=null};a.limparCampos=function(){a.bairro=null;a.cidade=null;a.estado=null;a.regiao=null;a.pais=null};a.existeEnderecoPrincipal=function(){var b=!1;angular.forEach(a.enderecos,function(a,c){a.enderecoPrincipal&&(b=!0)});return b};a.remarcarEnderecoPrincipal=
function(){angular.forEach(a.enderecos,function(b,d){!0===b.enderecoPrincipal&&a.endereco!=b&&(b.enderecoPrincipal=!1)});return!1};a.adicionarEndereco=function(){1>=a.enderecos.size?a.endereco.enderecoPrincipal=!0:!0===a.endereco.enderecoPrincipal&&a.remarcarEnderecoPrincipal();a.iniciarPropriedadesEndereco();var b=!0;a.bairro&&a.bairro.id?(a.endereco.bairro=a.bairro,a.obrigatorios.bairro=!1):(b=!1,a.obrigatorios.bairro=!0);a.cidade&&a.cidade.id?(a.endereco.cidade=a.cidade,a.obrigatorios.cidade=!1):
(b=!1,a.obrigatorios.cidade=!0);a.estado&&a.estado.id?(a.endereco.cidade.estado=a.estado,a.obrigatorios.estado=!1):(b=!1,a.obrigatorios.estado=!0);a.regiao&&a.regiao.id?(a.endereco.cidade.estado.regiao=a.regiao,a.obrigatorios.regiao=!1):(b=!1,a.obrigatorios.regiao=!0);a.pais&&a.pais.id?(a.endereco.cidade.estado.regiao.pais=a.pais,a.obrigatorios.pais=!1):(b=!1,a.obrigatorios.pais=!0);a.endereco.dominioTipoEndereco?a.obrigatorios.dominioTipoEndereco=!1:(b=!1,a.obrigatorios.dominioTipoEndereco=!0);!a.endereco.cep||
a.endereco.cep&&""==a.endereco.cep?(b=!1,a.obrigatorios.cep=!0):a.obrigatorios.cep=!1;!a.endereco.logradouro||a.endereco.logradouro&&""==a.endereco.logradouro?(b=!1,a.obrigatorios.logradouro=!0):a.obrigatorios.logradouro=!1;!a.endereco.complemento||a.endereco.complemento&&""==a.endereco.complemento?(b=!1,a.obrigatorios.complemento=!0):a.obrigatorios.complemento=!1;b&&(a.enderecos.push(a.endereco),a.endereco={},a.limparCampos());a.apresentarDialogConfirmacaoRemocaoEndereco=function(){angular.element("#citapp-controller").scope().$openModalConfirm({message:p.instant("LABEL.CONFIRMA_EXCLUSAO"),
callback:a.removerEndereco})};a.openModal=function(b,c){void 0!==b&&(a.$modalInstance=q.open({templateUrl:b,size:c,windowClass:"modal-buttons-top",backdrop:!1,scope:this}))};a.checkEndereco=function(b){a.removeCheckedEndereco();b.$checked=!0};a.removeCheckedEndereco=function(){a.enderecos.forEach(function(a){a.$checked=!1})};a.removerEndereco=function(){angular.forEach(a.enderecos,function(b,c){b.$checked&&(a.enderecos.splice(c,1),b.id&&s.remove(b).then(function(a){}))});a.$modalInstance.dismiss("cancel")}}}}}]);