citApp.controller("NivelAutoridadeController",["$scope","GrupoRepository","NivelAutoridadeRepository","$filter","$translate","$timeout",function(a,g,d,e,c,f){a.nivelAutoridade={};a.resetForm=function(){a.limparNivelAutoridade();a.edit=!0;f(function(){a.nivelAutoridadeForm.$submitted=!1;a.nivelAutoridadeForm.$setPristine()})};a.atualizaPaginaPesquisa=function(){angular.element("#searchNivelAutoridade").scope().fetchResult()};a.remove=function(b){a.nivelAutoridade=b;a.$openModalConfirm({message:c.instant("MSG.CONFIRMA_EXCLUSAO"),
callback:function(){d.remove(a.nivelAutoridade).then(function(){a.$modalConfirmInstance.dismiss("cancel");a.showAlert("success",c.instant("MSG.REGISTRO_EXCLUIDO"));angular.element("#searchNivelAutoridade").scope().fetchResult();a.resetForm()})}})};a.saveOrUpdate=function(){a.nivelAutoridadeForm.$submitted=!0;a.nivelAutoridadeForm.$valid?(a.setLoadingSalva(!0),d.save(a.nivelAutoridade).then(function(b){a.nivelAutoridade=b.originalElement;a.showAlert("success",c.instant("MSG.REGISTRO_SALVO"));a.nivelAutoridadeForm.$submitted=
!1;a.getNivelAutoridade(b.originalElement,!0);a.setLoading(!1)})):a.showAlert("error",c.instant("VALIDACAO.ALERTA_OBRIGATORIOS")," ",!1)};a.limparNivelAutoridade=function(){a.nivelAutoridade={}};a.getNivelAutoridade=function(b,c){a.setLoadingGet(!0);d.get(b.id).then(function(b){a.nivelAutoridade=b.originalElement;a.edit=c;a.nivelAutoridade.grupos=_.sortBy(a.nivelAutoridade.grupos,function(a){return a.grupo.nome});a.setLoading(!1)})};a.findGrupo=function(b){return g.findAutoComplete("nome",b).then(function(b){var c=
_.where(a.nivelAutoridade.grupos,{dataInativo:null});return e("idNotEqualGrupo")(b,c)})};a.setGrupo=function(b){a.nivelAutoridade.grupos||(a.nivelAutoridade.grupos=[]);var c=_.findIndex(a.nivelAutoridade.grupos,{grupo:{id:b.id}});0<=c?a.nivelAutoridade.grupos[c].dataInativo=null:a.nivelAutoridade.grupos.push({grupo:b,dataInativo:null});f(function(){a.grupo=null})};a.removerGrupo=function(){a.grupoChecked?a.$openModalConfirm({message:c.instant("MSG.DESEJA_EXCLUIR_ITENS"),callback:function(){a.$modalConfirmInstance.dismiss("cancel");
a.nivelAutoridade.grupos[a.grupoChecked.$index].dataInativo=e("date")(new Date,"dd/MM/yyyy");a.showAlert("success",c.instant("MSG.REGISTRO_EXCLUIDO"));a.grupoChecked={}}}):a.showAlert("warning",c.instant("MSG.SELECIONE_UM_ITEM_PARA_SER_REMOVIDO"))}}]);