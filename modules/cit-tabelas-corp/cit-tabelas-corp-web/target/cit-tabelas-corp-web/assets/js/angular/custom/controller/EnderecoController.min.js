citApp.controller("EnderecoController",["$scope","EnderecoRepository","DominioRepository","$translate","$timeout",function(a,d,f,b,e){a.endereco={};a.isBloquear=!1;a.isDesbloquear=!1;a.resetForm=function(){a.limparEndereco();a.edit=!0;a.pgEdit=!0;a.isBloquear=!1;a.isDesbloquear=a.isBloquear;e(function(){a.enderecoForm.$submitted=!1;a.enderecoForm.$setPristine()})};a.atualizaPaginaPesquisa=function(){angular.element("#searchEndereco").scope().fetchResult()};a.confirmarBloqueioEndereco=function(){if(a.endereco.dataBloqueio){var c=
converterStringEmDate(a.endereco.dataBloqueio);c>new Date||a.isDataIguais(c,new Date)?a.enderecoForm.$valid?(a.setLoadingSalva(!0),d.save(a.endereco).then(function(c){a.setLoadingSalva(!1);a.endereco=c.originalElement;a.carregarPaisRegiaoEstadoCidade();a.isDesbloquear=!0;a.isBloquear=!1;a.edit=!1;a.showAlert("success",b.instant("MSG.SUCESSO_BLOQUEIO"))})):a.showAlert("error",b.instant("VALIDACAO.ALERTA_OBRIGATORIOS")," ",!1):a.showAlert("error",b.instant("VALIDACAO.MN005"))}else a.showAlert("error",
b.instant("MSG.MG011")," ",!1)};a.isDataIguais=function(a,b){return a.getDate()==b.getDate()&&a.getMonth()==b.getMonth()&&a.getFullYear()==b.getFullYear()};a.desbloquear=function(){a.setLoadingSalva(!0);a.endereco.dataBloqueio=null;d.save(a.endereco).then(function(c){a.setLoadingSalva(!1);a.endereco=c.originalElement;a.carregarPaisRegiaoEstadoCidade();a.isBloquear=!0;a.isDesbloquear=!a.isBloquear;a.edit=!0;a.showAlert("success",b.instant("MSG.SUCESSO_DESBLOQUEIO"))})};a.remove=function(c){a.$openModalConfirm({message:b.instant("MSG.CONFIRMA_EXCLUIR_ENDERECO"),
callback:function(){d.remove(c).then(function(){a.endereco={};a.$modalConfirmInstance.dismiss("cancel");angular.element("#searchEndereco").scope().fetchResult();a.showAlert("success",b.instant("MSG.REGISTRO_EXCLUIDO"));a.resetForm()})}})};a.saveOrUpdate=function(){a.enderecoForm.$submitted=!0;a.enderecoForm.$valid?(a.setLoadingSalva(!0),d.save(a.endereco).then(function(c){a.endereco=c.originalElement;a.carregarPaisRegiaoEstadoCidade();a.isBloquear=!0;a.isDesbloquear=!a.isBloquear;a.showAlert("success",
b.instant("MSG.SUCESSO_ENDERECO"));a.enderecoForm.$submitted=!1;a.setLoading(!1)})):a.showAlert("error",b.instant("VALIDACAO.ALERTA_OBRIGATORIOS")," ",!1)};a.limparEndereco=function(){a.endereco={}};void 0==a.$parent||a.$parent.newObejct&&0==a.$parent.idObejct||(a.setLoadingGet(!0),d.get(a.$parent.idObejct).then(function(c){a.endereco=c.originalElement;a.setLoading(!1)}));a.carregarPaisRegiaoEstadoCidade=function(){a.endereco.$pais=a.endereco.bairro.cidade.estado.regiao.pais;a.endereco.$regiao=a.endereco.bairro.cidade.estado.regiao;
a.endereco.$estado=a.endereco.bairro.cidade.estado;a.endereco.$cidade=a.endereco.bairro.cidade};a.getEndereco=function(c,b){a.setLoadingGet(!0);d.get(c.id).then(function(c){a.endereco=c.originalElement;a.carregarPaisRegiaoEstadoCidade();null===a.endereco.dataBloqueio||void 0===a.endereco.dataBloqueio?(a.isBloquear=!0,a.isDesbloquear=!a.isBloquear,a.edit=b):(a.isBloquear=!1,a.isDesbloquear=!a.isBloquear,a.edit=!1);a.pgEdit=b;a.setLoading(!1)})}}]);